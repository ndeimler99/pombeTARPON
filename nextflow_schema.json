{
    "$schema": "http://json-schema.org/draft-07/schema",
    "$id": "https://raw.githubusercontent.com/ndeimler99/TArPON/master/nextflow_schema.json",
    "title": "ndeimler99/TArPON pipeline parameters",
    "description": "A pipeline to Analyze Telomeric sequences from Nanopore Sequencing",
    "type": "object",
    "definitions": {
        "Input_Output": {
            "title": "Input and Output Parameters",
            "type": "object",
            "fa_icon": "fas fa-arrow-right",
            "description": "Mandatory Parameters to set up the Analysis",
            "required": ["input", "outdir", "run_name"],
            "properties": {
                "input": {
                    "type": "string",
                    "format": "path",
                    "exists": true,
                    "title": "Input File",
                    "description": "Sequencing Files - Either a file directory or a single file - BAM, fastq, or fastq.gz accepted"
                },
                "run_name":{
                    "type": "string",
                    "title": "Run Name",
                    "description": "Title of Sequencing Run for Generation of Output Files"
                },
                "sample_name":{
                    "type": "string",
                    "title": "Sample Name",
                    "description": "Name of sample when sequencing contains only one sample"
                },
                "sample_file":{
                    "type": "string",
                    "format": "file-path",
                    "pattern": "\\S+csv$",
                    "title": "Sample File",
                    "description": "CSV file containing sample names and barcodes to use for demultiplexing. If no adaptor sequence is provided the barcodes will also be used for determing the end of the telomere",
                    "fa_icon": "fas fa-file-csv"
                },
                "adaptor_sequence": {
                    "type":"string",
                    "title":"Telomere Capture Sequence",
                    "description": "Provide the first 12 nucleotides of the capture sequence that would appear on the G strand telomeric sequences"
                },
                "outdir": {
                    "type": "string",
                    "format": "path",
                    "title": "Output Directory",
                    "default": "output",
                    "description": "This should be a path to a directory to store the output data. The parent directory should exist. If the main directory does not exist it will be created"
                },
                "overwrite_outdir": {
                    "type": "boolean",
                    "default":false,
                    "title": "Overwrite Output Directory?",
                    "description": "Set this to true if the output directory already exists but you would like to overwrite the data"
                },
                "demuxed": {
                    "type": "boolean",
                    "default" : false
                },
                "nanopore_barcodes": {
                    "type":"boolean",
                    "default":false
                },
                "nanopore_map": {
                    "type": "string",
                    "format": "path",
                    "exists": true
                }
            }
        },
    
        "Adaptor_Demux_Filter": {
            "title": "Adaptor Identification, Demultiplexing, and Subtelomeric Filtering Parameters",
            "type": "object",
            "fa_icon": "fas fa-arrow-right",
            "description": "Advanced Parameters relating to the identification of adaptor sequences, demultiplexing samples, and filtering telomeric reads by their subtelomere",
            "properties" : {
                "adaptor_sequence_errors":{
                    "type":"number",
                    "default":2,
                    "title": "Allowed Errors in Adaptor Sequence",
                    "description": "Number of allowed errors to be found in the adaptor sequence. The adaptor sequence wil only be found after ten telomeric repeats. It is recomended this value be 2 for a 12 nucleotide adaptor sequence. For each additional 8bp, the number of errors should be increased by 1"
                },
                "barcode_errors":{
                    "type":"number",
                    "default":3,
                    "title":"Allowed Errors in Barcode Sequences",
                    "description": "Number of allowed errors in the barcode sequence. It is recomended this value by 1/8 the length of the barcode assuming the hamming distance between barcodes is greater than 1/8 the barcode length"
                }
            }
        }
    },
    "allOf": [
        {
            "$ref": "#/definitions/Input_Output"
        },
        {
            "$ref": "#/definitions/Adaptor_Demux_Filter"
        }
    ],
    "resources": {
        "recommended": {
            "cpus": 2,
            "memory": "10GB"
        },
        "minimum": {
            "cpus": 2,
            "memory": "4GB"
        },
        "run_time": "Depends on Sequencing Size"
    }
}
